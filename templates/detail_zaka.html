{% extends "base.html" %}
{% block title %}Detail ≈æ√°ka{% endblock %}
{% block body_id %}detail-zaka{% endblock %}

{% block content %}
<h1>üèÉ V√Ωkony ≈æ√°ka ‚Äì {{ zak.jmeno }} {{ zak.prijmeni }}</h1>

<div class="content-zak">
    <!-- Lev√Ω sloupec ‚Äì osobn√≠ info -->
    <div class="left-side">
        <div class="student-info-wrapper">
            <table class="student-info-table">
                <tr>
                    <th>Jm√©no:</th>
                    <td>{{ zak.jmeno }}</td>
                </tr>
                <tr>
                    <th>P≈ô√≠jmen√≠:</th>
                    <td>{{ zak.prijmeni }}</td>
                </tr>
                <tr>
                    <th>T≈ô√≠da:</th>
                    <td>{{ zak.trida }}</td>
                </tr>
                <tr>
                    <th>Pohlav√≠:</th>
                    <td>{{ zak.pohlavi }}</td>
                </tr>
                <tr>
                    <th>Rok n√°stupu:</th>
                    <td>{{ zak.rok_nastupu }}</td>
                </tr>
            </table>
            <div class="logo-wrapper">
                {% if zak.pohlavi == 'chlapec' %}
                <img src="{{ url_for('static', filename='img/logo_chlapec.png') }}" class="logo-chlapec"
                    alt="Logo chlapec">
                {% else %}
                <img src="{{ url_for('static', filename='img/logo_divka.png') }}" class="logo-divka" alt="Logo d√≠vka">
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Prav√Ω sloupec ‚Äì body, pr≈Ømƒõr, zn√°mka -->
    <div class="right-side zak-points">
        <div class="info-box points-box">Body: <span id="total-points">0</span></div>
        <div class="info-box average-box">Pr≈Ømƒõr: <span id="average-points">0</span></div>
        <div class="info-box grade-box">Zn√°mka: <span id="final-grade">‚Äì</span></div>
        <div class="discipline-count-box">Splnƒõno: <span id="discipline-count">0</span> / {{ disciplines|length }}</div>
    </div>
</div>

<!-- V√Ωkonov√° tabulka -->
<div class="performance-section">
    <table class="discipline-table {{ zak.pohlavi }}">
        <thead>
            <tr>
                <th>Discipl√≠na</th>
                <th>V√Ωkon</th>
                <th>Body</th>
                <th>Jednotka</th>
            </tr>
        </thead>
        <tbody>
            {% for discipline in disciplines %}
            <tr data-discipline-id="{{ discipline.id }}">
                <td>{{ discipline.nazev }}</td>
                <td>
                    <input type="text" class="vykon-input" name="vykon_{{ discipline.id }}"
                        data-discipline-id="{{ discipline.id }}"
                        value="{{ student_scores.get(discipline.id, {}).get('vykon', '') }}"
                        onblur="handlePerformanceInput(this)" onkeydown="handleKeyPress(event, this)">
                </td>
                <td class="points-cell">{{ student_scores.get(discipline.id, {}).get('body', '') }}</td>
                <td>{{ discipline.jednotka }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- Bonusy a penalizace -->
<div class="bonus-section">
    <h2>Bonusov√© body</h2>
    <input type="number" id="bonus-input" class="bonus-input" value="{{ zak.bonus }}" onblur="handleExtraPoints()"
        onkeydown="handleKeyPress(event, this)">
</div>

<div class="penalty-section">
    <h2>Penalizace</h2>
    <input type="number" id="penalty-input" class="penalty-input" value="{{ zak.penalizace }}"
        onblur="handleExtraPoints()" onkeydown="handleKeyPress(event, this)">
</div>

<!-- Skryt√° metadata -->
<input type="hidden" id="zak-id" value="{{ zak.id }}">
<input type="hidden" id="skolni-rok" value="{{ vybrany_rok }}">
<input type="hidden" id="pohlavi" value="{{ zak.pohlavi }}">

{% endblock %}